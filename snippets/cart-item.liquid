{% doc %}
  
  Cart Item
  ------------------------------------------------------------------------------

  @param {object} item - The cart item to display

  @example
    {% render 'cart-item', item: item %}
{% enddoc %}

{% if item != blank %}
  <div
    class="ajax-cart__item"
    data-component="cart-item"
  >
    <div class="ajax-cart__item-inner">
      {%- if item.image -%}
        <img
          src="{{ item.image | image_url: width: 150 }}"
          alt="{{ item.image.alt | escape }}"
          loading="lazy"
          width="150"
          height="{{ 150 | divided_by: item.image.aspect_ratio | ceil }}"
          class="lazy-image"
        >
      {% endif %}

      <div class="flex-1 flex flex-col justify-between gap-y-4 pt-0.5">
        <div>
          <div class="flex justify-between">
            <div>
              <a href="{{ item.product.url }}">
                {{- item.product.title | escape -}}
              </a>
            </div>
            
            <button
              class="uppercase underline"
              type="button"
              aria-label="Remove {{ item.product.title | escape }} from cart"
              data-remove
            >Remove</button>
          </div>

          {% capture item_details %}
            {% unless item.product.has_only_default_variant %}
              {% for option in item.options_with_values -%}
                <li>{{ option.name }}: {{ option.value }}</li>
              {%- endfor %}
            {% endunless %}
            
            {% for property in item.properties %}
              {% comment %} https://shopify.dev/docs/api/ajax/reference/cart#private-properties-and-attributes {% endcomment %}
              {% assign first_characater = property.first | slice: 0 %}
              {% unless first_characater == '_' %}
                <li>{{ property.first }}: {{ property.last }}</li>
              {% endunless %}
            {% endfor %}
          {% endcapture %}

          {%- if item_details != blank %}
            <ul>{{ item_details }}</ul>
          {% endif %}          
        </div>

        <div class="flex justify-between">
          <div>
            {%- liquid
              assign max = item.variant.quantity_rule.max
  
              if max == blank and item.variant.inventory_management != nil and item.variant.inventory_policy == 'deny'
                assign max = item.variant.inventory_quantity
              endif
            -%}

            {%- render 'quantity-adjuster',
                        value: item.quantity,
                        min: 0,
                        max: max,
                        step: item.variant.quantity_rule.increment,
                        input_name: 'updates[]',
                        product_title: item.product.title
            -%}
          </div>
          <div>{% render 'cart-item-price', item: item %}</div>
        </div>
      </div>
    </div>       
  </div>
{% endif %}